# Main скрипт
Это главный скрипт, который делает всю работу по тренировке и evaluation. Этот скрипт посвящен одному таску (MP, MM или JE), но одновременно всем типам данных (Например, ADT->GEX, GEX->ADT и тд.). В Main скрипте обязательно есть функция `predict_submission`. Эта функция будет посылаться на сервер при создании посылки.

Она принимает:
- аргументы таска (в случае MP это input_train_mod1, input_train_mod2 и input_test_mod1).
- путь к ресурсам (`lab_scripts`, `checkpoints` и `configs`).

Она возвращает:
- AnnData с предсказаниями. 


## Когда создавать Main скрипт?
Один Main скрипт = Одно решение таска. Скорее всего, это решение использует свои собственные модели, но возможна ситуация, в которой мы обучим большую модель для получения эмбедингов и будем переиспользоваться ее в разных задачах.

## Как создать Main скрипт?
Единственное условие -- это наличие функции `predict_submission`. Наверняка вы не хотите хардкодить параметры модели в код, поэтому для экспериментов используйте разные файлы конфигурации. Когда вы подберете желаемые параметры, захардкодьте путь к файлу конфигурации в `predict_submission`.

Тренировку и локальные запуски можно организовать по-разному. Например, я делаю так: в `main.py` запускается cli-интерфейс, которому передается команда `train` или `evaluate` и файл конфигурации. Соответствующие функции загружают данные, модель из чекпоинта (если это `evaluate`) и передают готовые объекты моделям, которые находятся в отдельных скриптах: `lab_scripts/models/...`. Модели ничего не знают про файловую систему и сразу получают словарь конфигураций, объект весов и данные. Это позволяет работать из командной строки, и экспериментировать в Jupyter Notebook: самостоятельно открыть данные, импортировать готовую модель из `lab_scripts/models/..` и передать в нее нужные аргументы.

Хорошее правило: В main у нас открытие файлов и их обработка, а в `lab_scripts/models/..` модели, которые ничего не знают про пути. main можно запустить из консоли, а модели можно загрузить и использовать в ноутбуке.

Смотрите примеры в `baseline_linear`, `baseline_pytorch` и ноутбуках из папки `notebook/examples`.